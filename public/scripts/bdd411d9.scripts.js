"use strict";angular.module("acnEventsApp",["ngResource","ngRoute","ui.bootstrap","ui.bootstrap.modal"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"RegistrationCtrl"}).when("/registrations/:id/confirm",{templateUrl:"views/main.html",controller:"ConfirmRegistrationCtrl"}).when("/registrations/:id/unregister",{templateUrl:"views/main.html",controller:"DeleteRegistrationCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("acnEventsApp").factory("registrationService",["$resource","$q",function(a,b){var c=a("/api/event/"),d=a("/api/event/registrations/:id",{id:"@id"},{update:{method:"PUT"}}),e=a("/api/event/registrations/:id/confirm",{id:"@id"},{update:{method:"PUT"}});return{count:function(){var a=b.defer();return c.get(function(b){a.resolve(b.countConfirmed)},function(b){a.reject(b)}),a.promise},create:function(a){var c=b.defer();return d.save(a,function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},confirm:function(a){var c=b.defer();return console.log("confirm"),e.save({id:a},function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},"delete":function(a){var c=b.defer();return console.log("delete"),d.delete({id:a},function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise}}}]),angular.module("acnEventsApp").controller("RegistrationCtrl",["$scope","$modal","registrationService","$timeout",function(a,b,c,d){var e=function(){a.registration={person:{}},a.registrationForm&&(a.registrationForm.$pristine=!0)};c.count().then(function(b){a.numRegistrations=b});var f=function(){d(function(){c.count().then(function(b){a.numRegistrations=b}),f()},1e4)};f(),a.ok=function(){a.modal.close()},a.create=function(d){a.error=null,c.create(d).then(function(c){console.log(c),a.modal=b.open({templateUrl:"successModal.html",backdrop:!0,keyboard:!0,backdropClick:!0,scope:a})},function(b){a.error=b.data||b})},e()}]),angular.module("acnEventsApp").controller("ConfirmRegistrationCtrl",["$scope","$modal","$routeParams","registrationService","$timeout",function(a,b,c,d,e){d.count().then(function(b){a.numRegistrations=b});var f=function(){e(function(){d.count().then(function(b){a.numRegistrations=b}),f()},1e4)};f(),a.ok=function(){console.log("confirm ok()"),a.modal.close()},d.confirm(c.id).then(function(){a.modal=b.open({templateUrl:"confirmModal.html",backdrop:!0,keyboard:!0,backdropClick:!0,scope:a})},function(c){a.error=c.data||c,a.modal=b.open({templateUrl:"confirmErrorModal.html",backdrop:!0,keyboard:!0,backdropClick:!0,scope:a})})}]),angular.module("acnEventsApp").controller("DeleteRegistrationCtrl",["$scope","$modal","$routeParams","registrationService","$timeout",function(a,b,c,d,e){d.count().then(function(b){a.numRegistrations=b});var f=function(){e(function(){d.count().then(function(b){a.numRegistrations=b}),f()},1e4)};f(),a.ok=function(){a.modal.close()},d.delete(c.id).then(function(c){console.log(c),a.modal=b.open({templateUrl:"unregisterModal.html",backdrop:!0,keyboard:!0,backdropClick:!0,scope:a})},function(c){a.error=c.data||c,a.modal=b.open({templateUrl:"confirmErrorModal.html",backdrop:!0,keyboard:!0,backdropClick:!0,scope:a})})}]);